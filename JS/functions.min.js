function randcolor(){for(var a="#"+(16777215*Math.random()<<0).toString(16);a.length<7;)a="#0"+a.substr(1);return a}function loadjs(a,e){$("#"+e).remove();var o=document.createElement("script");o.type="text/javascript",o.id=e,o.src=a,document.getElementsByTagName("head")[0].appendChild(o)}function onokmodal(){var a="";if(1===game.init&&$("#nJugadores").val()<2&&(game.init=0),1===game.init&&$("#nJugadores").val()>1){game.init++,game.nplayers=$("#nJugadores").val(),game.initmoney=$("#inicial").val();for(var e=1;e<=game.nplayers;e++)a+="<table class='table' id='jugador"+e+"'><thead><tr><th><center><b>Jugador: "+e+"</b></center></th></tr></thead><tbody><tr><td><div class='form-group row'><label for='Nombre"+e+"' class='col-xs-2 col-form-label'>Nombre:</label><div class='col-xs-10'><input type='text' id='Nombre"+e+"' class='form-control input-sm' placeholder='AndRBR'></div></div><div class='form-group row'><label for='colorsel"+e+"' class='col-xs-2 col-form-label'>Color:</label><div class='col-xs-10'><input type='color' id='colorsel"+e+"' class='form-control input-sm' value='"+randcolor()+"'></div><script>game['players']["+e+"] = {name: '', color: $('#colorsel"+e+"').val(), money: game['initmoney'], worth: game['initmoney'], houses: 0, hotels: 0};$('#colorsel"+e+"').change(function(){game['players']["+e+"].color = $(this).val();});$('#Nombre"+e+"').change(function(){game['players']["+e+"].name = $(this).val();});</script></div></td></tr><tbody></table>"}else if(0===game.init)game.init++,a="<center><div class='cant-dinero'><div id='bill'></div><script>drawbill('bill', ($(document).width() < 450) ? $(document).width()-50 : 400, '#d7ce22', 'mainbill');</script><h1 class='indicador-dinero'></h1></div></center><div id='optjuego'><div id='divinicial' class='form-group row'><label for='inicial' class='col-xs-3 col-form-label'>Dinero Inicial:</label><div class='input-group col-xs-9'><input id='inicial'class='form-control input-sm'type='number'onchange='setInitialMoney()'value='0'><script>setInitialMoney();</script><div class='currencysymbol input-group-addon'></div></div></div><div class='form-group row'><label for='nJugadores' class='col-xs-3 col-form-label'># Jugadores:</label><div class='col-xs-9'><input id='nJugadores'type='number'class='form-control input-sm'value='0'min='0'max='9'step='1'></div></div></div>";else{game.hist=[],datafolder=$("#versionsel").val(),loadeconomicdata(datafolder),loadcardstext(datafolder),$(".playersel").each(function(){$(this).html("");for(var a=0;a<=game.nplayers;a++)$(this).append("<option value="+a+">"+game.players[a].name+"</option>")}),updateplayertable(),$("#histdatatable").DataTable().clear(),$("#modaldialog").modal("hide")}$("#modaldialogbody").html(a)}function loadcardstext(a){loadjs("JS/"+a+"/cards.min.js","cardscript")}function loadcarddialogdata(a){switch(a){case"chance":$("#carddialogtitle").html("Casualidad");break;case"comunitychest":$("#carddialogtitle").html("Arca Comunal")}$("#carddialogtxt").html(getrandcard(a))}function getrandcard(a){var e=Math.floor(Math.random()*game.cards[a].length),o=game.cards[a][e];switch(o=o.replace(/'-goamount-'/g,game.goamount),Math.floor(2*Math.random())){case 0:e=Math.floor(Math.random()*game.avalprops.length),o=o.replace(/\'-street-\'/g,game.avalprops[e]),o=o.replace(/\'-utility-\'/g,game.propsdet.utilities.electric);break;case 1:e=Math.floor(Math.random()*game.soldprops.length),o=o.replace(/\'-street-\'/g,game.soldprops[e]),o=o.replace(/\'-utility-\'/g,game.propsdet.utilities.water)}return e=Math.floor(Math.random()*game.propsdet.railroads.names.length),o=o.replace(/\'-railroad-\'/g,game.propsdet.railroads.names[e]),o=o.replace(/\'-goamount-\'/g,game.goamount)}function loadeconomicdata(a){loadjs("JS/"+a+"/economic_data.min.js","economic_data")}function setInitialMoney(){var a=$("#inicial").val();$(".indicador-dinero").html(a+" "+currencysym)}function updateplayertable(){$("#playerstable").DataTable().clear();for(var a=0;a<=game.nplayers;a++)$("#playerstable").DataTable().row.add([game.players[a].color,game.players[a].name,game.players[a].money,game.players[a].worth]);$("#playerstable").DataTable().draw()}function movetosold(a){game.soldprops.push(game.avalprops[a]),game.avalprops.splice(a,1),updatepropsels()}function movetomort(a){game.mortprops.push(game.soldprops[a]),updatepropsels()}function paidmort(a){game.mortprops.splice(a,1),updatepropsels()}function movetoaval(a){game.avalprops.push(game.soldprops[a]),game.soldprops.splice(a,1),updatepropsels()}function updatepropsels(){$("#avalpropsel").html(""),$("#soldpropsel").html(""),$("#mortpropsel").html("");for(var a=0;a<game.avalprops.length;a++)$("#avalpropsel").append("<option value="+a+">"+game.avalprops[a]+"</option>");for(var a=0;a<game.soldprops.length;a++)$("#soldpropsel").append("<option value="+a+">"+game.soldprops[a]+"</option>");for(var a=0;a<game.mortprops.length;a++)$("#mortpropsel").append("<option value="+a+">"+game.mortprops[a]+"</option>")}function setcurrency(){$(".currencysymbol").html(currencysym)}function transfer(){var a=$("#transfromplayer").prop("selectedIndex"),e=$("#transtoplayer").prop("selectedIndex"),o=$("#transamount").val();game.players[a].money=parseFloat(game.players[a].money)-parseFloat(o),game.players[e].money=parseFloat(game.players[e].money)+parseFloat(o),game.players[a].worth=parseFloat(game.players[a].worth)-parseFloat(o),game.players[e].worth=parseFloat(game.players[e].worth)+parseFloat(o),appendtransaction(a,e,o),updateplayertable()}function purchase(){var a=$("#transfromplayer").prop("selectedIndex"),e=$("#transtoplayer").prop("selectedIndex"),o=$("#transamount").val();game.players[a].worth=parseFloat(game.players[a].worth)+parseFloat(o),game.players[e].worth=parseFloat(game.players[e].worth)-parseFloat(o),transfer()}function appendtransaction(a,e,o){game.hist.push({from:game.players[a].name,to:game.players[e].name,amount:parseFloat(o)}),$("#histdatatable").DataTable().row.add([game.players[a].name,game.players[e].name,o+currencysym]).draw()}var currencysym="",datafolder="",game={init:0,nplayers:0,initmoney:0,goamount:0,players:[],cards:{},taxes:{income:["10%",0],luxury:0},propsdet:{utilities:{},railroads:{},streets:[]},avalprops:[],soldprops:[],mortprops:[],hist:[]};game.players[0]={name:"Banco",color:"",money:1/0,worth:1/0,houses:{},hotels:{}};