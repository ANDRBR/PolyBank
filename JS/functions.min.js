function myTimer(){var a=(new Date).getTime(),e=target_date-a;return e<10?(stopTmr(),void clearTmr()):(hours=parseInt(e/36e5),e%=36e5,minutes=parseInt(e/6e4),e=parseInt(e%6e4),seconds=parseInt(e/1e3),milliseconds=parseInt(e%1e3/10),$("#auctionhoursleft").html(pad2(hours)),$("#auctionminsleft").html(pad2(minutes)),$("#auctionsecsleft").html(pad2(seconds)),void $("#auctionmillsleft").html(pad2(milliseconds)))}function stopTmr(){clearInterval(tmr)}function clearTmr(){clearInterval(tmr),$(".tmr-segment").html("00")}function pad2(a){return(a<10?"0":"")+a}function ColorLuminance(a,e){a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),e=e||0;var r,o,t="#";for(o=0;o<3;o++)r=parseInt(a.substr(2*o,2),16),r=Math.round(Math.min(Math.max(0,r+r*e),255)).toString(16),t+=("00"+r).substr(r.length);return t}function randcolor(){for(var a="#"+(16777215*Math.random()<<0).toString(16);a.length<7;)a="#0"+a.substr(1);return a}function loadjs(a,e){$("#"+e).remove();var r=document.createElement("script");r.type="text/javascript",r.id=e,r.src=a,document.getElementsByTagName("head")[0].appendChild(r)}function onokmodal(){var a="";if(1===game.init&&$("#nJugadores").val()<2&&(game.init=0),1===game.init&&$("#nJugadores").val()>1){game.init++,game.nplayers=$("#nJugadores").val(),game.initmoney=$("#inicial").val();for(var e=1;e<=game.nplayers;e++)a+="<table class='table' id='jugador"+e+"'><thead><tr><th><center><b>Jugador: "+e+"</b></center></th></tr></thead><tbody><tr><td><div class='form-group row'><label for='Nombre"+e+"' class='col-xs-2 col-form-label'>Nombre:</label><div class='col-xs-10'><input type='text' id='Nombre"+e+"' class='form-control input-sm' placeholder='AndRBR'></div></div><div class='form-group row'><label for='colorsel"+e+"' class='col-xs-2 col-form-label'>Color:</label><div class='col-xs-10'><input type='color' id='colorsel"+e+"' class='form-control input-sm' value='"+randcolor()+"'></div><script>game['players']["+e+"] = {name: '', color: $('#colorsel"+e+"').val(), money: game['initmoney'], worth: game['initmoney'], properties: [], houses: 0, hotels: 0};$('#colorsel"+e+"').change(function(){game['players']["+e+"].color = $(this).val();});$('#Nombre"+e+"').change(function(){game['players']["+e+"].name = $(this).val();});</script></div></td></tr><tbody></table>"}else if(0===game.init)game.init++,a="<center><div class='cant-dinero'><div id='bill'></div><h1 class='indicador-dinero'></h1></div></center><div id='optjuego'><div id='divinicial' class='form-group row'><label for='inicial' class='col-xs-3 col-form-label'>Dinero Inicial:</label><div class='input-group col-xs-9'><input id='inicial'class='form-control input-sm'type='number'onchange='setInitialMoney()'value='0'><div class='currencysymbol input-group-addon'></div></div></div><div class='form-group row'><label for='nJugadores' class='col-xs-3 col-form-label'># Jugadores:</label><div class='col-xs-9'><input id='nJugadores'type='number'class='form-control input-sm'value='0'min='0'max='9'step='1'></div></div></div>",$(document).ready(function(a){drawbill("bill",a(document).width()<450?a(document).width()-50:400,"#d7ce22","mainbill"),setInitialMoney()});else{game.hist=[],datafolder=$("#versionsel").val(),loadeconomicdata(datafolder),loadcardstext(datafolder),$(".playersel").html("");for(var e=0;e<=game.nplayers;e++)$(".playersel").append("<option value="+e+">"+game.players[e].name+"</option>");updateplayertable(),$("#histdatatable").DataTable().clear(),$("#modaldialog").modal("hide")}$("#modaldialogbody").html(a)}function loadcardstext(a){loadjs("JS/"+a+"/cards.min.js","cardscript")}function loadcarddialogdata(a){switch(a){case"chance":$("#carddialogtitle").html("Casualidad");break;case"comunitychest":$("#carddialogtitle").html("Arca Comunal")}$("#carddialogtxt").html(getrandcard(a))}function sellaval(){var a=$("#sellavalprop").prop("selectedIndex"),e=$("#sellavalpropto").prop("selectedIndex"),r=parseFloat($("#sellavalpropcost").html());game.players[e].properties.push(game.avalprops[a]),addmoney(e,-r),addworth(e,r),movetosold(a),appendtohistory(0,e,r,histdescriptions.propsell),updateplayertable(),$("#sellavalpropcost").html(findinprops(game.avalprops[$("#sellavalprop").val()]).price)}function getrandcard(a){var e=Math.floor(Math.random()*game.cards[a].length),r=game.cards[a][e];switch(r=r.replace(/'-goamount-'/g,game.goamount),Math.floor(2*Math.random())){case 0:e=Math.floor(Math.random()*game.avalprops.length),r=r.replace(/\'-street-\'/g,game.avalprops[e]),r=r.replace(/\'-utility-\'/g,game.propsdet.utilities.electric);break;case 1:e=Math.floor(Math.random()*game.soldprops.length),r=r.replace(/\'-street-\'/g,game.soldprops[e]),r=r.replace(/\'-utility-\'/g,game.propsdet.utilities.water)}return e=Math.floor(Math.random()*game.propsdet.railroads.names.length),r=r.replace(/\'-railroad-\'/g,game.propsdet.railroads.names[e]),r=r.replace(/\'-goamount-\'/g,game.goamount)}function loadeconomicdata(a){loadjs("JS/"+a+"/economic_data.min.js","economic_data")}function updateplayertable(){$("#playerstable").DataTable().clear();for(var a=0;a<=game.nplayers;a++)$("#playerstable").DataTable().row.add([game.players[a].color,game.players[a].name,game.players[a].money,game.players[a].worth]);$("#playerstable").DataTable().draw()}function movetosold(a){game.soldprops.push(game.avalprops[a]),game.avalprops.splice(a,1),updatepropsels()}function movetomort(a){game.mortprops.push(game.soldprops[a]),updatepropsels()}function paidmort(a){game.mortprops.splice(a,1),updatepropsels()}function movetoaval(a){game.avalprops.push(game.soldprops[a]),game.soldprops.splice(a,1),updatepropsels()}function updatepropsels(){$(".avalprop").html(""),$("#soldpropsel").html(""),$("#mortpropsel").html("");for(var a=0;a<game.avalprops.length;a++)$(".avalprop").append("<option value="+a+">"+game.avalprops[a]+"</option>");for(var a=0;a<game.soldprops.length;a++)$("#soldpropsel").append("<option value="+a+">"+game.soldprops[a]+"</option>");for(var a=0;a<game.mortprops.length;a++)$("#mortpropsel").append("<option value="+a+">"+game.mortprops[a]+"</option>")}function setcurrency(){$(".currencysymbol").html(currencysym)}function transfer(){var a=$("#transfromplayer").prop("selectedIndex"),e=$("#transtoplayer").prop("selectedIndex"),r=$("#transamount").val();addmoney(a,-r),addmoney(e,r),addworth(a,-r),addworth(e,r),appendtohistory(a,e,r,histdescriptions.transfer),updateplayertable()}function addmoney(a,e){game.players[a].money=parseFloat(game.players[a].money)+parseFloat(e)}function addworth(a,e){game.players[a].worth=parseFloat(game.players[a].worth)+parseFloat(e)}function purchase(){var a=$("#transfromplayer").prop("selectedIndex"),e=$("#transtoplayer").prop("selectedIndex"),r=$("#transamount").val();addworth(a,r),addworth(e,-r),transfer()}function appendtohistory(a,e,r,o){game.hist.push({from:game.players[a].name,to:game.players[e].name,amount:parseFloat(r),description:o}),$("#histdatatable").DataTable().row.add([game.hist.length,game.players[a].name,game.players[e].name,r+currencysym,o]).draw()}function setInitialMoney(){var a=$("#inicial").val();$(".indicador-dinero").html(a+" "+currencysym)}function findinprops(a){if(game.propsdet.utilities.electric===a||game.propsdet.utilities.water===a)return game.propsdet.utilities;for(var e=0;e<game.propsdet.railroads.names.length;e++)if(game.propsdet.railroads.names[e]===a)return game.propsdet.railroads;for(var e=0;e<game.propsdet.streets.length;e++)for(var r=0;r<game.propsdet.streets[e].data.length;r++)if(game.propsdet.streets[e].data[r].name===a)return game.propsdet.streets[e].data[r]}var tmr,target_datehours,minutes,seconds,milliseconds,currencysym="",datafolder="",histdescriptions={transfer:"Transferencia",propsell:"Venta de propiedad"},game={init:0,nplayers:0,initmoney:0,goamount:0,players:[],cards:{},taxes:{income:["10%",0],luxury:0},propsdet:{utilities:{},railroads:{},streets:[]},avalprops:[],soldprops:[],mortprops:[],hist:[]};game.players[0]={name:"Banco",color:"",money:1/0,worth:1/0,properties:[],houses:{},hotels:{}},$(document).ready(function(){var a,e="",r=datasources.length;$('[data-toggle="tooltip"]').tooltip();for(var a=1;a<5;a++)e+="<li id='rail"+a+"'></li>";for($("#railinfonames").html(e),e="",a=1;a<5;a++)e+="<li><strong>"+a+" Ferrocarril"+(a>1?"es":"")+": </strong><span class='gamelang' id='railrent"+a+"'></span> <span class='currencysymbol gamelang'></span></li>";for($("#railinforents").html(e),a=0;a<r;a++)$("#versionsel").append("<option id='version"+a+"' value="+datasources[a].folder+"><span>"+datasources[a].folder.split("_")[0]+"</span>: "+datasources[a].version+"</option>");onokmodal(),currencysym=datasources[0].currency,setcurrency(),$("#modaldialog").modal("show"),$("#sellavalprop").change(function(){var a=game.avalprops[$("#sellavalprop").val()];$("#sellavalpropcost").html(findinprops(a).price)}),$("#navbar-newgame").click(function(){game.init=0,onokmodal()}),$("#navbar-chance").click(function(){loadcarddialogdata("chance")}),$("#navbar-comchest").click(function(){loadcarddialogdata("comunitychest")}),$("#transferbtn").click(function(){transfer()}),$("#newgame-ok-btn").click(function(){onokmodal()}),$("#versionsel").change(function(){currencysym=datasources[$("#versionsel").prop("selectedIndex")].currency,setcurrency()}),$(window).resize(function(){$("#bill").length&&drawbill("bill",$(window).width()<450?$(window).width()-50:400,"#d7ce22","mainbill")}),$("#starttmr-btn").click(function(){target_date=new Date(Date.now()+10*parseInt($("#tmr-mills").val())+1e3*parseInt($("#tmr-secs").val())+6e4*parseInt($("#tmr-mins").val())+36e5*parseInt($("#tmr-hours").val())).getTime(),tmr=setInterval(function(){myTimer()},10)}),$("#stoptmr-btn").click(function(){stopTmr()}),$("#resettmr-btn").click(function(){clearTmr()}),$("#transgoamount").click(function(){$("#transamount").val(game.goamount),$("#transfromplayer").val("0")}),$("#luxurytaxbtn").click(function(){$("#transamount").val(game.taxes.luxury),$("#transtoplayer").val("0")}),$("#incometaxbtn").click(function(){$("#transamount").val(game.taxes.income[1]),$("#transtoplayer").val("0")}),$(".DataTable").DataTable({language:{sProcessing:"Procesando...",sLengthMenu:"Mostrar _MENU_ registros",sZeroRecords:"No se encontraron resultados",sEmptyTable:"Ningún dato disponible en esta tabla",sInfo:"Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",sInfoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",sInfoFiltered:"(filtrado de un total de _MAX_ registros)",sInfoPostFix:"",sSearch:"Buscar:",sUrl:"",sInfoThousands:",",sLoadingRecords:"Cargando...",oPaginate:{sFirst:"Primero",sLast:"Último",sNext:"Siguiente",sPrevious:"Anterior"},oAria:{sSortAscending:": Activar para ordenar la columna de manera ascendente",sSortDescending:": Activar para ordenar la columna de manera descendente"}},scrollY:300,scrollX:!0,scrollCollapse:!0,columnDefs:[{targets:0,createdCell:function(a,e,r,o,t){7===e.length&&/#[0-9|a-f]{6}/i.test(e)&&($(a).css("background-color",e),$(a).html(""))}}]})});